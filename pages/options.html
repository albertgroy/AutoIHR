<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>插件配置 - Boss 职位采集</title>
    <link rel="stylesheet" href="../content/dashboard/style.less" />
  </head>
  <body>
    <div id="options-root">
      <h1>插件配置</h1>

      <div class="section">
        <h2>采集设置</h2>
        <div class="form-group">
          <label for="interval">采集间隔（分钟）：</label>
          <input type="number" id="interval" min="1" max="60" value="5" />
        </div>

        <div class="form-group">
          <label for="max-jobs">最大采集数量：</label>
          <input type="number" id="max-jobs" min="10" max="1000" value="100" />
        </div>
      </div>

      <div class="section">
        <h2>数据管理</h2>
        <button id="export-btn">导出数据</button>
        <button id="clear-btn">清除数据</button>
      </div>

      <div class="section">
        <h2>高级设置</h2>
        <div class="form-group">
          <label for="debug-mode">调试模式：</label>
          <input type="checkbox" id="debug-mode" />
        </div>
      </div>
    </div>

    <script>
      // 加载保存的配置
      chrome.storage.sync.get(
        ["interval", "maxJobs", "debugMode"],
        (settings) => {
          document.getElementById("interval").value = settings.interval || 5;
          document.getElementById("max-jobs").value = settings.maxJobs || 100;
          document.getElementById("debug-mode").checked =
            settings.debugMode || false;
        }
      );

      // 保存配置更改
      document.querySelectorAll("input, select").forEach((element) => {
        element.addEventListener("change", saveSettings);
      });

      function saveSettings() {
        const settings = {
          interval: parseInt(document.getElementById("interval").value),
          maxJobs: parseInt(document.getElementById("max-jobs").value),
          debugMode: document.getElementById("debug-mode").checked,
        };
        chrome.storage.sync.set(settings);
      }

      // 处理数据管理操作
      document.getElementById("export-btn").addEventListener("click", () => {
        chrome.runtime.sendMessage({ action: "exportData" });
      });

      document.getElementById("clear-btn").addEventListener("click", () => {
        if (confirm("确定要清除所有采集数据吗？")) {
          chrome.runtime.sendMessage({ action: "clearData" });
        }
      });
    </script>
  </body>
</html>
